<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Organize your routes with Vue Router · Igor Kostyuchenok</title><meta name="description" content="Organize your routes with Vue Router - Igor Kostyuchenok"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://kostyuchenok.com/atom.xml" title="Igor Kostyuchenok"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Igor Kostyuchenok" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/services/" target="_self" class="nav-list-link">SERVICES</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="https://t.me/FinTechNewz" target="_blank" class="nav-list-link">FINTECHNEWZ</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Organize your routes with Vue Router</h1><div class="post-info">Feb 5, 2021</div><div class="post-content"><p>Everyone has its own view on how to organize the routes in a Single-Page Application-we’re not different.</p>
<p>Since we’re using <a target="_blank" rel="noopener" href="https://vuejs.org/">Vue.js</a> in our current project, we’re also using the <a target="_blank" rel="noopener" href="https://router.vuejs.org/">Vue Router</a>.</p>
<p>Here I would like to describe the approach we took to organize our router and its routes. We will probably change/improve the current state later on but for now I will describe the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Status_quo">status quo</a>.</p>
<span id="more"></span>

<h3 id="Folder-structure"><a href="#Folder-structure" class="headerlink" title="Folder structure"></a>Folder structure</h3><p>We made a couple of iterations on how we want to organize our routes and we will definitely run through a couple of more iterations until we’re fully satisfied.</p>
<div style="text-align: center;">
  <img src="https://cdn-images-1.medium.com/max/2704/1*Pj1ezbBzQnG4NHlD0seaWg.png" width="400px" />
</div>

<p>Current folder structure we use is pretty straightforward:</p>
<ul>
<li><p><code>index.js</code>- defines the <code>beforeEach</code> logic for the routes</p>
</li>
<li><p><code>/routes/public.js</code> — holds all the public routes (e.g. /, /login, /registration etc.)</p>
</li>
<li><p><code>/routes/private.js</code> — has all the routes for the authenticated user</p>
</li>
<li><p><code>/routes/index.js</code> - just concatenates all the public and private routes and exports them</p>
</li>
</ul>
<p>Let’s walk quickly through every file — you’ll see it will all make sense very quickly.</p>
<h3 id="src-router-index-js"><a href="#src-router-index-js" class="headerlink" title="src/router/index.js"></a><code>src/router/index.js</code></h3><p><code>index.js</code> only holds one root route (you can also go without it). In our case it’s the dashboard route, the user is redirected to once authenticated.</p>
<p>Ok, so the most important part of the <code>index.js</code> is the <code>beforeEach</code> check.</p>
<p>In our application we have two types of routes:</p>
<ul>
<li><p>the strictly public ones — you have to be logged out to visit them</p>
</li>
<li><p>the private ones - you have to be authenticated to visit them</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store/index.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> routes <span class="keyword">from</span> <span class="string">&#x27;@/router/routes/index.js&#x27;</span></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">      <span class="attr">redirect</span>: <span class="string">&#x27;/dashboard&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ].concat(routes)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> authenticated = store.state.user.authenticated</span><br><span class="line">  <span class="keyword">const</span> onlyLoggedOut = to.matched.some(<span class="function"><span class="params">record</span> =&gt;</span> record.meta.onlyLoggedOut)</span><br><span class="line">  <span class="keyword">const</span> isPublic = to.matched.some(<span class="function"><span class="params">record</span> =&gt;</span> record.meta.public)</span><br><span class="line">  <span class="keyword">if</span> (!isPublic &amp;&amp; !authenticated) &#123;</span><br><span class="line">    <span class="comment">// this route requires auth, check if logged in</span></span><br><span class="line">    <span class="comment">// if not, redirect to login page.</span></span><br><span class="line">    <span class="keyword">return</span> next(&#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">      <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: to.fullPath &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (authenticated &amp;&amp; onlyLoggedOut) &#123;</span><br><span class="line">    <span class="keyword">return</span> next(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p>As you can see from the code snippet above, we read the authentication state from the local <a target="_blank" rel="noopener" href="https://vuex.vuejs.org/">Vuex</a> store. Other information that we need to decide whether a route can be visited or not is stored in the <a target="_blank" rel="noopener" href="https://router.vuejs.org/guide/advanced/meta.html">meta field</a> of the routes:</p>
<ul>
<li><p><code>onlyLoggedOut</code> — a route can only be visited by a non authenticated user</p>
</li>
<li><p><code>isPublic</code> - it’s a public route and can be visited without authentication (<code>/login</code>, <code>/registration</code> etc.)</p>
</li>
</ul>
<p>There are only two cases (we’d like to keep it simple in the beginning):</p>
<ul>
<li><p><code>!isPublic &amp;&amp; !authenticated</code> — the user is not authenticated but is trying to access the private route — he/she’ll be redirected to the <code>/login</code> page and will be redirected to the page he was trying to access upon successful authentication</p>
</li>
<li><p><code>authenticated &amp;&amp; onlyLoggedOut</code> - the user is authenticated but is trying to access the public page — he’ll be redirected back to the dashboard</p>
</li>
</ul>
<h3 id="src-router-routes-public-js"><a href="#src-router-routes-public-js" class="headerlink" title="src/router/routes/public.js"></a><code>src/router/routes/public.js</code></h3><p>We were thinking about breaking down the routes and put every one of them into its own file, but, mmm-maybe later :).</p>
<p>Ok, so all the public routes are in one file and all of them rock the same meta field:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meta: &#123;</span><br><span class="line">  <span class="attr">public</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">onlyLoggedOut</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Login <span class="keyword">from</span> <span class="string">&#x27;@/views/Login.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Registration <span class="keyword">from</span> <span class="string">&#x27;@/views/Registration.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ForgotPassword <span class="keyword">from</span> <span class="string">&#x27;@/views/ForgotPassword.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;login&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Login</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/registration&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;registration&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Registration</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/forgot-password&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;forgotPassword&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: ForgotPassword</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> routes.map(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> meta = &#123;</span><br><span class="line">    <span class="attr">public</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">onlyLoggedOut</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123; ...route, meta &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>In order to not pollute every route, we’re adding the meta field to all the routes in the file in the export section. This way we don’t have to think about adding the meta field to every new added route.</p>
<h3 id="src-router-routes-private-js"><a href="#src-router-routes-private-js" class="headerlink" title="src/router/routes/private.js"></a><code>src/router/routes/private.js</code></h3><p>You know the drill by now. All the private routes reside in one file and the meta field is added to each and one of them in the export section.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Accounts <span class="keyword">from</span> <span class="string">&#x27;@/views/Accounts/Index.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Dashboard <span class="keyword">from</span> <span class="string">&#x27;@/views/Dashboard/Index.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Settings <span class="keyword">from</span> <span class="string">&#x27;@/views/Settings/Index.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/accounts&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;accounts&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Accounts</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/dashboard&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;dashboard&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Dashboard</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/settings&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;settings&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: Settings</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> routes.map(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; ...route, <span class="attr">meta</span>: &#123; <span class="attr">public</span>: <span class="literal">false</span> &#125; &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="src-router-routes-index-js"><a href="#src-router-routes-index-js" class="headerlink" title="src/router/routes/index.js"></a><code>src/router/routes/index.js</code></h3><p>What’s inside of the <code>routes/index.js</code> you may ask. It’s just the utility file that imports the routes from both <code>public.js</code> and <code>private.js</code> and exports them as one.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> publicRoutes <span class="keyword">from</span> <span class="string">&#x27;@/router/routes/public.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> privateRoutes <span class="keyword">from</span> <span class="string">&#x27;@/router/routes/private.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> publicRoutes.concat(privateRoutes)</span><br></pre></td></tr></table></figure>

<p>This file is not necessary, you could just import public and private routes directly into the <code>src/router/index.js</code></p>
<p>That’s all folks!</p>
</div></article></div></main><footer><div class="paginator"><a href="/2021/04/10/mock-promisified-aws-sdk-calls/" class="prev">PREV</a></div><div class="copyright"><p>© 2021 - 2023 <a href="https://kostyuchenok.com">Igor Kostyuchenok</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-42619461-1",'auto');ga('send','pageview');</script></body></html>